<div class="wrapper">
  <div class="section-registro">
    <div class="body-registro">

      <!-- Título dinámico -->
      <div class="row mt-3 mb-3">
        <div class="form-group col-12">
          <label class="title-user">
            {{ editar ? 'Editar Materia' : 'Registro de Materia' }}
          </label>
        </div>
      </div>

      <!-- NRC -->
      <div class="section-header">Información General</div>

      <mat-form-field appearance="outline">
        <mat-label>NRC</mat-label>
        <input
          matInput
          [(ngModel)]="materia.nrc"
          name="nrc"
          mask="00000"
          placeholder="Ej. 12345"
          [disabled]="editar"
        >
      </mat-form-field>
      <div *ngIf="errors.nrc" class="error-msg">{{ errors.nrc }}</div>

      <!-- Nombre -->
      <mat-form-field appearance="outline">
        <mat-label>Nombre de la materia</mat-label>
        <input
          matInput
          [(ngModel)]="materia.nombre"
          name="nombre"
          (keypress)="soloLetras($event)"
          placeholder="Ej. Programación"
        >
      </mat-form-field>
      <div *ngIf="errors.nombre" class="error-msg">{{ errors.nombre }}</div>

      <!-- Sección -->
      <mat-form-field appearance="outline">
        <mat-label>Sección</mat-label>
        <input
          matInput
          [(ngModel)]="materia.seccion"
          name="seccion"
          mask="000"
          placeholder="Ej. 001"
        >
      </mat-form-field>
      <div *ngIf="errors.seccion" class="error-msg">{{ errors.seccion }}</div>

      <!-- Días -->
      <div class="section-header">Días de Clase</div>

      <label class="subtitle-field">Selecciona los días:</label>
      <section class="checkbox-section">
        <mat-checkbox
          class="example-margin"
          *ngFor="let dia of diasSemana"
          [checked]="materia.dias.includes(dia.value)"
          (change)="checkboxChange($event, dia.value)"
          color="primary"
        >
          {{ dia.nombre }}
        </mat-checkbox>
      </section>
      <div *ngIf="errors.dias" class="error-msg">{{ errors.dias }}</div>

      <!-- Horario -->
      <div class="section-header">Horario</div>

      <div class="row">
        <!-- Hora inicio -->
        <div class="col-md-6 col-12">
          <mat-form-field appearance="outline">
            <mat-label>Hora de inicio</mat-label>
            <input
              matInput
              [ngxTimepicker]="pickerInicio"
              readonly
              [(ngModel)]="materia.hora_inicio"
              name="hora_inicio"
              placeholder="07:00 AM"
            >
            <mat-icon matSuffix style="cursor:pointer" (click)="pickerInicio.open()">access_time</mat-icon>
          </mat-form-field>

          <ngx-material-timepicker #pickerInicio [format]="12"></ngx-material-timepicker>
          <div *ngIf="errors.hora_inicio" class="error-msg">{{ errors.hora_inicio }}</div>
        </div>

        <!-- Hora fin -->
        <div class="col-md-6 col-12">
          <mat-form-field appearance="outline">
            <mat-label>Hora de fin</mat-label>
            <input
              matInput
              [ngxTimepicker]="pickerFin"
              readonly
              [(ngModel)]="materia.hora_fin"
              name="hora_fin"
              placeholder="09:00 AM"
            >
            <mat-icon matSuffix style="cursor:pointer" (click)="pickerFin.open()">access_time</mat-icon>
          </mat-form-field>

          <ngx-material-timepicker #pickerFin [format]="12"></ngx-material-timepicker>
          <div *ngIf="errors.hora_fin" class="error-msg">{{ errors.hora_fin }}</div>
        </div>
      </div>

      <!-- Salón -->
      <div class="section-header">Aula y Programa</div>

      <mat-form-field appearance="outline">
        <mat-label>Salón</mat-label>
        <input
          matInput
          [(ngModel)]="materia.salon"
          name="salon"
          maxlength="15"
          (keypress)="soloAlfanumerico($event)"
        >
        <mat-hint align="end">{{ materia.salon?.length || 0 }}/15</mat-hint>
      </mat-form-field>
      <div *ngIf="errors.salon" class="error-msg">{{ errors.salon }}</div>

      <!-- Programa educativo -->
      <mat-form-field appearance="outline">
        <mat-label>Programa Educativo</mat-label>
        <mat-select [(ngModel)]="materia.programa_educativo" name="programa">
          <mat-option *ngFor="let programa of programas" [value]="programa">
            {{ programa }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div *ngIf="errors.programa_educativo" class="error-msg">{{ errors.programa_educativo }}</div>

      <!-- Profesor -->
      <mat-form-field appearance="outline">
        <mat-label>Profesor Asignado</mat-label>
        <mat-select [(ngModel)]="materia.profesor" name="profesor">
          <mat-option *ngFor="let maestro of listaMaestros" [value]="maestro.id">
            {{ maestro.user.first_name }} {{ maestro.user.last_name }}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <div *ngIf="errors.profesor" class="error-msg">{{ errors.profesor }}</div>

      <!-- Créditos -->
      <mat-form-field appearance="outline">
        <mat-label>Créditos</mat-label>
        <input
          matInput
          [(ngModel)]="materia.creditos"
          name="creditos"
          mask="00"
        >
      </mat-form-field>
      <div *ngIf="errors.creditos" class="error-msg">{{ errors.creditos }}</div>

      <!-- Botones -->
      <div class="section-buttons">
        <button class="btn btn-danger" (click)="regresar()">Cancelar</button>

        <button *ngIf="!editar" class="btn btn-primary" (click)="registrar()">
          Registrar
        </button>

        <button *ngIf="editar" class="btn btn-primary" (click)="actualizar()">
          Actualizar
        </button>
      </div>

    </div>
  </div>
</div>
